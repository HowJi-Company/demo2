import{d as H,r as m,c as d,o as F,a as K,b as J,k as Q,i as r,f as y,A as U,p as _,n as O,g as X,h as Z,B as ee,C as te,D as oe}from"./index-BOktFF9V.js";import{M as k}from"./MetallicButton-C5zqWCAB.js";import{f as se,r as re,a as ae,b as le,c as ne,d as ie,e as ce}from"./result2-BqxVhMQC.js";import{w as ue}from"./warning_footer-D9FTkEpB.js";import{_ as de}from"./_plugin-vue_export-helper-DlAUqK2U.js";const pe="/assets/download-DbNsp3t3.png",fe={class:"relative mx-auto flex min-h-[100vh] w-full max-w-[480px] flex-col items-center justify-start overflow-visible pb-16"},we=["src"],ve={class:"relative w-full overflow-visible"},me=["src"],he={class:"relative w-full overflow-visible"},ge=["src"],xe=["src"],be={class:"scroll-indicator pointer-events-none fixed bottom-12 left-1/2 z-50 w-full max-w-[480px] -translate-x-1/2"},ye=ee('<div class="scroll-indicator-float" data-v-2fe9551d><svg class="scroll-arrow-icon arrow-top" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-2fe9551d><path d="M7 10L12 15L17 10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-2fe9551d></path></svg><div class="scroll-text" data-v-2fe9551d>請向下滑動</div><svg class="scroll-arrow-icon arrow-bottom" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-2fe9551d><path d="M7 10L12 15L17 10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-2fe9551d></path></svg></div>',1),_e=[ye],j="wineQuizAnswers",ke=40,Ee=H({__name:"ResultView",setup(Le){const E=X(),h=Z(),z=[[[4,4,4,4,3,3],[4,2,2,4,6,6],[4,6,6,4,3,3],[4,3,3,4,6,6]],[[3,3,1,6,3,3],[3,3,3,5,4,4],[6,6,5,3,4,2],[4,3,6,1,4,6]],[[3,3,6,3,4,5],[6,4,1,5,3,2],[1,4,5,3,3,5],[5,4,2,5,6,2]],[[4,4,4,4,3,3],[4,2,2,4,6,6],[4,6,6,4,3,3],[4,3,3,4,6,6]]],M=["kaoliang","bowmore","ginjo","wine","universe","imo"],g={"result85%":0,"result70%":1,"result65%":2,"result40%":3,"result35%":4,"result20%":5},B={0:"result85%",1:"result70%",2:"result65%",3:"result40%",4:"result35%",5:"result20%"},N=m(null),p=m(!0),L=m(!1),i=m([0,0,0,0,0,0]),x=d(()=>{const e=h.query.type;return e&&g[e]!==void 0?g[e]:null}),T=d(()=>{let e=0;for(let t=1;t<i.value.length;t++)i.value[t]>i.value[e]&&(e=t);return e}),f=d(()=>x.value!==null?x.value:T.value),R=d(()=>M[f.value]),$={kaoliang:re,bowmore:ae,ginjo:le,wine:ne,universe:ie,imo:ce},w=d(()=>$[R.value]),q=d(()=>["高粱","波摩","吟釀","紅酒","小宇宙","芋燒酎"].map((t,s)=>({label:t,score:i.value[s]}))),V=["高粱","波摩","吟釀","紅酒","小宇宙","芋燒酎"],P=()=>{const e=window.scrollY||document.documentElement.scrollTop||0;p.value=e<=ke},A=async()=>{try{const e=w.value,t=await fetch(e);if(!t.ok)throw new Error("無法載入圖片");const s=await t.blob(),o=`專屬酒款_${["高粱","波摩","吟釀","紅酒","小宇宙","芋燒酎"][f.value]}.png`,c=URL.createObjectURL(s),u=/iPad|iPhone|iPod/.test(navigator.userAgent),l=/Android/.test(navigator.userAgent),b=u||l,a=document.createElement("a");a.href=c,b?(a.target="_blank",a.rel="noopener noreferrer",l&&(a.download=o)):a.download=o,document.body.appendChild(a),a.click(),document.body.removeChild(a),setTimeout(()=>{URL.revokeObjectURL(c)},1e3)}catch(e){console.error("下載圖片失敗:",e),window.open(w.value,"_blank")}},W=()=>oe("shareTargetPicker"),Y=async()=>{const e=window.location.origin+window.location.pathname+"#/cover",t="來測測你的專屬酒款！",s="我剛完成了酒款測驗，快來測測你的專屬酒款是什麼吧！",n=V[f.value];if(W()){const o=w.value,c=o.startsWith("http://")||o.startsWith("https://");let u;c?u=[{type:"flex",altText:`${s}
${e}`,contents:{type:"bubble",hero:{type:"image",url:o,size:"full",aspectRatio:"20:13",aspectMode:"cover"},body:{type:"box",layout:"vertical",contents:[{type:"text",text:t,weight:"bold",size:"xl",wrap:!0},{type:"text",text:`我的專屬酒款是：${n}`,margin:"md",size:"md",color:"#666666",wrap:!0},{type:"text",text:s,margin:"md",size:"sm",color:"#999999",wrap:!0}]},footer:{type:"box",layout:"vertical",spacing:"sm",contents:[{type:"button",style:"primary",height:"sm",action:{type:"uri",label:"立即測驗",uri:e},color:"#000000"}]}}}]:u=[{type:"text",text:`${t}

我的專屬酒款是：${n}

${s}

${e}`}];try{await te.shareTargetPicker(u),console.log("LINE 分享成功");return}catch(l){if(l.name!=="AbortError")console.error("LINE 分享失敗:",l);else return}}if(navigator.share)try{await navigator.share({title:t,text:s,url:e});return}catch(o){o.name!=="AbortError"&&console.error("分享失敗:",o)}try{await navigator.clipboard.writeText(e),alert("連結已複製到剪貼板！")}catch(o){console.error("複製連結失敗:",o),prompt("請複製以下連結分享給好友：",e)}},D=()=>{try{localStorage.removeItem(j)}catch(e){console.error("清除答案記錄失敗:",e)}E.push({name:"cover"})},G=()=>{window.open("https://liquorexplorer.cyberbiz.co/zh-TW/account/signup","_blank","noopener,noreferrer")};return F(()=>{var s;requestAnimationFrame(()=>{L.value=!0}),p.value=!0,window.addEventListener("scroll",P,{passive:!0});const e=h.query.type;if(e&&g[e]!==void 0)console.log("使用 URL 參數指定的類型:",e,"對應索引:",x.value),i.value=[0,0,0,0,0,0];else try{const n=localStorage.getItem(j);if(!n){console.warn("未找到答案資料");return}const o=JSON.parse(n),c=[0,0,0,0,0,0];for(const{question:b,answer:a}of o){const I=b,S=a,C=(s=z[I])==null?void 0:s[S];if(!C){console.warn(`找不到題目 ${I} 選項 ${S} 的積分`);continue}for(let v=0;v<6;v++)c[v]+=C[v]}i.value=c,console.log("各類型分數:",q.value),console.log("最高分類型:",R.value,"分數:",i.value[f.value]);const u=T.value,l=B[u];l&&(E.replace({query:{...h.query,type:l}}),console.log("已更新 URL 參數:",l))}catch(n){console.error("讀取 / 計算結果失敗",n)}}),K(()=>{window.removeEventListener("scroll",P)}),(e,t)=>(J(),Q("main",{ref_key:"mainRef",ref:N,class:O(["relative min-h-screen w-full bg-black font-sans",{"fade-in":L.value}])},[r("div",fe,[r("img",{src:w.value,alt:"你的專屬酒款",class:"h-auto w-full cursor-pointer object-contain",onClick:A},null,8,we),r("div",ve,[r("img",{src:y(pe),alt:"下載圖片",class:"h-auto w-full cursor-pointer object-contain",onClick:A},null,8,me),r("div",{class:"buttons-container absolute left-1/2 top-[51%] z-10 flex w-full max-w-full -translate-x-1/2 -translate-y-1/2 flex-row items-center justify-center gap-3 px-4 sm:gap-4",onClick:t[0]||(t[0]=U(()=>{},["stop"]))},[_(k,{text:"分享好友",onClick:Y,showStars:!0,width:"140px",height:"42px",starLeftOffset:"-16px",starRightOffset:"-16px"}),_(k,{text:"再玩一次",onClick:D,showStars:!0,width:"140px",height:"42px",starLeftOffset:"-16px",starRightOffset:"-16px"})])]),r("div",he,[r("img",{src:y(se),alt:"結果頁 2",class:"h-auto w-full object-contain"},null,8,ge),r("div",{class:"signup-button-container absolute left-1/2 top-[85%] z-10 flex w-full max-w-full -translate-x-1/2 -translate-y-1/2 items-center justify-center px-4",onClick:t[1]||(t[1]=U(()=>{},["stop"]))},[_(k,{text:"註冊會員享單杯品飲卷",onClick:G,showStars:!0,width:"280px",height:"42px",starLeftOffset:"-36px",starRightOffset:"-36px"})])])]),r("img",{src:y(ue),alt:"警告標語",class:"warning-footer fixed bottom-0 left-1/2 z-40 w-full max-w-[480px] -translate-x-1/2"},null,8,xe),r("div",be,[r("div",{class:O(["scroll-indicator-inner",{"scroll-indicator-visible":p.value,"scroll-indicator-hidden":!p.value}])},_e,2)])],2))}}),Se=de(Ee,[["__scopeId","data-v-2fe9551d"]]);export{Se as default};
